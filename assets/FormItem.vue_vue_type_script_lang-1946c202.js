var X=Object.defineProperty,Y=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var z=(e,f,h)=>f in e?X(e,f,{enumerable:!0,configurable:!0,writable:!0,value:h}):e[f]=h,d=(e,f)=>{for(var h in f||(f={}))ee.call(f,h)&&z(e,h,f[h]);if(B)for(var h of B(f))te.call(f,h)&&z(e,h,f[h]);return e},E=(e,f)=>Y(e,Z(f));import{c as F,u as n,d as oe,G as ne,n as se,l as g,i as le,ac as H,z as ae,E as re}from"./vue-ea98dac5.js";import{c as J}from"./componentMap-60b4a45b.js";import{n as C,z as $,i as ce,c as ie,a6 as de,a7 as fe,a8 as me}from"./index.js";import{N as ue,c as K,s as he}from"./helper-1d3a8892.js";import{i as be}from"./isNumber-f0336cfd.js";import{i as D}from"./isBoolean-9388e2d6.js";import{q as G,E as pe,y as ge}from"./antd-c2e94c83.js";function ye(e){return"slot"in e}function Ce(e){return!ye(e)}function Pe(e,f){return F(()=>{const h=n(e),{labelCol:v={},wrapperCol:O={}}=h.itemProps||{},{labelWidth:k,disabledLabelWidth:b}=h,{labelWidth:P,labelCol:S,wrapperCol:L,layout:q}=n(f);if(!P&&!k&&!S||b)return v.style={textAlign:"left"},{labelCol:v,wrapperCol:O};let x=k||P;const T=d(d({},S),v),N=d(d({},L),O);return x&&(x=be(x)?`${x}px`:x),{labelCol:d({style:{width:x}},T),wrapperCol:d({style:{width:q==="vertical"?"100%":`calc(100% - ${x})`}},N)}})}function W(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!le(e)}const Me=oe({name:"BasicFormItem",inheritAttrs:!1,props:{schema:{type:Object,default:()=>({})},formProps:{type:Object,default:()=>({})},allDefaultValues:{type:Object,default:()=>({})},formModel:{type:Object,default:()=>({})},setFormModel:{type:Function,default:null},tableAction:{type:Object},formActionType:{type:Object},isAdvanced:{type:Boolean}},setup(e,{slots:f}){const{t:h}=ce(),{schema:v,formProps:O}=ne(e),k=Pe(v,O),b=F(()=>{const{allDefaultValues:o,formModel:t,schema:a}=e,{mergeDynamicData:l}=e.formProps;return{field:a.field,model:t,values:d(d(d({},l),o),t),schema:a}}),P=F(()=>{var r;const{schema:o,tableAction:t,formModel:a,formActionType:l}=e;let{componentProps:s={}}=o;return C(s)&&(s=(r=s({schema:o,tableAction:t,formModel:a,formActionType:l}))!=null?r:{}),o.component==="Divider"&&(s=Object.assign({type:"horizontal"},{orientation:"left",plain:!0},s)),s}),S=F(()=>{const{disabled:o}=e.formProps,{dynamicDisabled:t}=e.schema,{disabled:a=!1}=n(P);let l=!!o||a;return D(t)&&(l=t),C(t)&&(l=t(n(b))),l}),L=F(()=>{const{readonly:o}=e.formProps,{dynamicReadonly:t}=e.schema,{readonly:a=!1}=n(P);let l=o||a;return D(t)&&(l=t),C(t)&&(l=t(n(b))),l});function q(){const{show:o,ifShow:t}=e.schema,{showAdvancedButton:a}=e.formProps,l=a&&D(e.isAdvanced)?e.isAdvanced:!0;let s=!0,r=!0;return D(o)&&(s=o),D(t)&&(r=t),C(o)&&(s=o(n(b))),C(t)&&(r=t(n(b))),s=s&&l,{isShow:s,isIfShow:r}}function x(){var M;const{rules:o=[],component:t,rulesMessageJoinLabel:a,label:l,dynamicRules:s,required:r}=e.schema;if(C(s))return s(n(b));let c=ie(o);const{rulesMessageJoinLabel:R}=e.formProps,w=(Reflect.has(e.schema,"rulesMessageJoinLabel")?a:R)?l:"",p=t?K(t)+w:w;function m(u,i){const y=u.message||p;return i===void 0||fe(i)||Array.isArray(i)&&i.length===0||typeof i=="string"&&i.trim()===""||typeof i=="object"&&Reflect.has(i,"checked")&&Reflect.has(i,"halfChecked")&&Array.isArray(i.checked)&&Array.isArray(i.halfChecked)&&i.checked.length===0&&i.halfChecked.length===0?Promise.reject(y):Promise.resolve()}const j=C(r)?r(n(b)):r;j&&(!c||c.length===0?c=[{required:j,validator:m}]:c.findIndex(i=>Reflect.has(i,"required"))===-1&&c.push({required:j,validator:m}));const _=c.findIndex(u=>Reflect.has(u,"required")&&!Reflect.has(u,"validator"));if(_!==-1){const u=c[_],{isShow:i}=q();if(i||(u.required=!1),t){u.message=u.message||p,(t.includes("Input")||t.includes("Textarea"))&&(u.whitespace=!0);const y=(M=n(P))==null?void 0:M.valueFormat;he(u,t,y)}}const A=c.findIndex(u=>u.max);return A!==-1&&!c[A].validator&&(c[A].message=c[A].message||h("component.form.maxTip",[c[A].max])),c}function T(){var u;if(!Ce(e.schema))return null;const{renderComponentContent:o,component:t,field:a,changeEvent:l="change",valueField:s}=e.schema,r=t&&["Switch","Checkbox"].includes(t),c=`on${me(l)}`,R={[c]:(...i)=>{const[y]=i;m[c]&&m[c](...i);const V=y?y.target:null,Q=V?r?V.checked:V.value:y;e.setFormModel(a,Q,e.schema)}},I=J.get(t),{autoSetPlaceHolder:w,size:p}=e.formProps,m=E(d({allowClear:!0,size:p},n(P)),{disabled:n(S),readonly:n(L)});!m.disabled&&w&&t!=="RangePicker"&&t&&(m.placeholder=((u=n(P))==null?void 0:u.placeholder)||K(t)),m.codeField=a,m.formValues=n(b);const _={[s||(r?"checked":"value")]:e.formModel[a]},A=d(d(d({},m),R),_);if(!o)return g(I,A,null);const M=C(o)?d({},o(n(b),{disabled:n(S),readonly:n(L)})):{default:()=>o};return g(I,A,W(M)?M:{default:()=>[M]})}function N(){const{label:o,helpMessage:t,helpComponentProps:a,subLabel:l}=e.schema,s=l?g("span",null,[o,re(" "),g("span",{class:"text-secondary"},[l])]):o,r=C(t)?t(n(b)):t;return!r||Array.isArray(r)&&r.length===0?s:g("span",null,[s,g(de,H({placement:"top",class:"mx-1",text:r},a),null)])}function U(){const{itemProps:o,slot:t,render:a,field:l,suffix:s,component:r}=e.schema,{labelCol:c,wrapperCol:R}=n(k),{colon:I}=e.formProps,w={disabled:n(S),readonly:n(L)};if(r==="Divider"){let p;return g(G,{span:24},{default:()=>[g(pe,n(P),W(p=N())?p:{default:()=>[p]})]})}else{const p=()=>t?$(f,t,n(b),w):a?a(n(b),w):T(),m=!!s,j=C(s)?s(n(b)):s;return r&&ue.includes(r)&&e.schema&&(e.schema.itemProps=d({autoLink:!1},e.schema.itemProps)),g(ge.Item,H({name:l,colon:I,class:{"suffix-item":m}},o,{label:N(),rules:x(),labelCol:c,wrapperCol:R}),{default:()=>[g("div",{style:"display:flex"},[g("div",{style:"flex:1;"},[p()]),m&&g("span",{class:"suffix"},[j])])]})}}return()=>{let o;const{colProps:t={},colSlot:a,renderColContent:l,component:s,slot:r}=e.schema;if(!s||!J.has(s)&&!r)return null;const{baseColProps:c={}}=e.formProps,R=d(d({},c),t),{isIfShow:I,isShow:w}=q(),p=n(b),m={disabled:n(S),readonly:n(L)};return I&&se(g(G,R,W(o=(()=>a?$(f,a,p,m):l?l(p,m):U())())?o:{default:()=>[o]}),[[ae,w]])}}});export{Me as _};
