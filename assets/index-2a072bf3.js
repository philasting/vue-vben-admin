var Ve=Object.defineProperty,He=Object.defineProperties;var Re=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var Ye=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable;var ie=(e,t,n)=>t in e?Ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,O=(e,t)=>{for(var n in t||(t={}))Ye.call(t,n)&&ie(e,n,t[n]);if(se)for(var n of se(t))Xe.call(t,n)&&ie(e,n,t[n]);return e},ue=(e,t)=>He(e,Re(t));var oe=(e,t,n)=>new Promise((y,v)=>{var S=k=>{try{p(n.next(k))}catch(E){v(E)}},r=k=>{try{p(n.throw(k))}catch(E){v(E)}},p=k=>k.done?y(k.value):Promise.resolve(k.value).then(S,r);p((n=n.apply(e,t)).next())});import{an as ze,d as _e,f as Te,ag as We,c as I,w as $,Z as M,_ as U,u,N as qe,ab as m,a8 as G,a9 as j,E as de,a0 as he,a1 as fe,l as L,F as z,aa as Ze,ai as Ge,aj as Je,A as Qe,m as ye,r as pe,H as X,h as V,o as et,n as ge,z as ke,ac as tt,i as nt}from"./vue-ea98dac5.js";import{aW as at,aX as lt,aY as ct,aZ as rt,a_ as st,a$ as it,b0 as ut,b1 as Se,b2 as ot,b3 as dt,ag as ht,i as ft,u as yt,ac as pt,I as Q,q as gt,c as ee,b4 as Ke,R as kt,o as St,n as J,b5 as Kt,az as xt,b6 as bt,a9 as xe,ab as At,V as Ct,z as be}from"./index.js";import{av as Lt,d as vt,aw as Et,ax as _t,D as Tt,i as wt,Y as Bt,ah as Ae}from"./antd-c2e94c83.js";import{u as Dt}from"./useContextMenu-eb0dfce9.js";import{g as Ft}from"./get-3d19de2f.js";import{i as Ce}from"./isBoolean-9388e2d6.js";var Nt=200;function Mt(e,t,n,y){var v=-1,S=rt,r=!0,p=e.length,k=[],E=t.length;if(!p)return k;n&&(t=at(t,lt(n))),y?(S=st,r=!1):t.length>=Nt&&(S=it,r=!1,t=new ct(t));e:for(;++v<p;){var K=e[v],d=n==null?K:n(K);if(K=y||K!==0?K:0,r&&d===d){for(var a=E;a--;)if(t[a]===d)continue e;k.push(K)}else S(t,d,y)||k.push(K)}return k}var It=ut(function(e,t){return Se(e)?Mt(e,ot(t,1,Se,!0)):[]});const Ot=It;function mt(e){for(var t=-1,n=e==null?0:e.length,y={};++t<n;){var v=e[t];y[v[0]]=v[1]}return y}function te(e,t){return t?typeof t=="string"?` ${e}--${t}`:Array.isArray(t)?t.reduce((n,y)=>n+te(e,y),""):Object.keys(t).reduce((n,y)=>n+(t[y]?te(e,y):""),""):""}function $t(e){return(t,n)=>(t&&typeof t!="string"&&(n=t,t=""),t=t?`${e}__${t}`:e,`${t}${te(t,n)}`)}function we(e){return[$t(`${dt}-${e}`)]}const Le=Symbol(),ve=Symbol();function Pt(e,t){if(!ht(e)||e[ve])return e;const{values:n,required:y,default:v,type:S,validator:r}=e,p=n||r?k=>{let E=!1,K=[];if(n&&(K=[...n,v],E||(E=K.includes(k))),r&&(E||(E=r(k))),!E&&K.length>0){const d=[...new Set(K)].map(a=>JSON.stringify(a)).join(", ");ze(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${d}], got value ${JSON.stringify(k)}.`)}return E}:void 0;return{type:typeof S=="object"&&Object.getOwnPropertySymbols(S).includes(Le)&&S?S[Le]:S,required:!!y,default:v,validator:p,[ve]:!0}}const Ut=e=>mt(Object.entries(e).map(([t,n])=>[t,Pt(n,t)]));var T=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(T||{});const jt=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],Vt=Ut({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:[Array,Object],default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1},treeWrapperClassName:String}),Ht={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},Rt=_e({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:t}){const n=e,y=Te(""),[v]=we("tree-header"),S=We(),{t:r}=ft(),p=I(()=>["mr-1","w-full",{"ml-5":S.headerTitle||n.title}]),k=I(()=>{const{checkable:a}=n,c=[{label:r("component.tree.expandAll"),value:T.EXPAND_ALL},{label:r("component.tree.unExpandAll"),value:T.UN_EXPAND_ALL,divider:a}];return a?[{label:r("component.tree.selectAll"),value:T.SELECT_ALL},{label:r("component.tree.unSelectAll"),value:T.UN_SELECT_ALL,divider:a},...c,{label:r("component.tree.checkStrictly"),value:T.CHECK_STRICTLY},{label:r("component.tree.checkUnStrictly"),value:T.CHECK_UN_STRICTLY}]:c}),E=({key:a})=>{var c,s,h,o;switch(a){case T.SELECT_ALL:(c=n.checkAll)==null||c.call(n,!0);break;case T.UN_SELECT_ALL:(s=n.checkAll)==null||s.call(n,!1);break;case T.EXPAND_ALL:(h=n.expandAll)==null||h.call(n,!0);break;case T.UN_EXPAND_ALL:(o=n.expandAll)==null||o.call(n,!1);break;case T.CHECK_STRICTLY:t("strictly-change",!1);break;case T.CHECK_UN_STRICTLY:t("strictly-change",!0);break}};function K(a){t("search",a)}const d=yt(K,200);return $(()=>y.value,a=>{d(a)}),$(()=>n.searchText,a=>{a!==y.value&&(y.value=a)}),(a,c)=>(M(),U("div",{class:fe([u(v)(),"flex px-2 py-1.5 items-center"])},[u(S).headerTitle?qe(a.$slots,"headerTitle",{key:0}):m("",!0),!u(S).headerTitle&&a.title?(M(),G(u(pt),{key:1,helpMessage:a.helpMessage},{default:j(()=>[de(he(a.title),1)]),_:1},8,["helpMessage"])):m("",!0),a.search||a.toolbar?(M(),U("div",Ht,[a.search?(M(),U("div",{key:0,class:fe(p.value)},[L(u(Lt),{placeholder:u(r)("common.searchText"),size:"small",allowClear:"",value:y.value,"onUpdate:value":c[0]||(c[0]=s=>y.value=s)},null,8,["placeholder","value"])],2)):m("",!0),a.toolbar?(M(),G(u(Tt),{key:1,onClick:c[1]||(c[1]=Qe(()=>{},["prevent"]))},{overlay:j(()=>[L(u(vt),{onClick:E},{default:j(()=>[(M(!0),U(z,null,Ze(k.value,s=>(M(),U(z,{key:s.value},[L(u(Et),Ge(Je({key:s.value})),{default:j(()=>[de(he(s.label),1)]),_:2},1040),s.divider?(M(),G(u(_t),{key:0})):m("",!0)],64))),128))]),_:1})]),default:j(()=>[L(Q,{icon:"ion:ellipsis-vertical"})]),_:1})):m("",!0)])):m("",!0)],2))}}),Yt=({icon:e})=>e?gt(e)?ye(Q,{icon:e,class:"mr-1"}):ye(Q):null;function Xt(e,t){function n(d){const a=[],c=d||u(e),{key:s,children:h}=u(t);if(!h||!s)return a;for(let o=0;o<c.length;o++){const i=c[o];a.push(i[s]);const g=i[h];g&&g.length&&a.push(...n(g))}return a}function y(d){const a=[],c=d||u(e),{key:s,children:h}=u(t);if(!h||!s)return a;for(let o=0;o<c.length;o++){const i=c[o];i.disabled!==!0&&i.selectable!==!1&&a.push(i[s]);const g=i[h];g&&g.length&&a.push(...y(g))}return a}function v(d,a){const c=[],s=a||u(e),{key:h,children:o}=u(t);if(!o||!h)return c;for(let i=0;i<s.length;i++){const g=s[i],_=g[o];d===g[h]?(c.push(g[h]),_&&_.length&&c.push(...n(_))):_&&_.length&&c.push(...v(d,_))}return c}function S(d,a,c){if(!d)return;const s=c||u(e),{key:h,children:o}=u(t);if(!(!o||!h))for(let i=0;i<s.length;i++){const g=s[i],_=g[o];if(g[h]===d){s[i]=O(O({},s[i]),a);break}else _&&_.length&&S(d,a,g[o])}}function r(d=1,a,c=1){if(!d)return[];const s=[],h=a||u(e)||[];for(let o=0;o<h.length;o++){const i=h[o],{key:g,children:_}=u(t),W=g?i[g]:"",P=_?i[_]:[];s.push(W),P&&P.length&&c<d&&(c+=1,s.push(...r(d,P,c)))}return s}function p({parentKey:d=null,node:a,push:c="push"}){const s=ee(u(e));if(!d){s[c](a),e.value=s;return}const{key:h,children:o}=u(t);!o||!h||(Ke(s,i=>{if(i[h]===d)return i[o]=i[o]||[],i[o][c](a),!0}),e.value=s)}function k({parentKey:d=null,list:a,push:c="push"}){const s=ee(u(e));if(!(!a||a.length<1))if(d){const{key:h,children:o}=u(t);if(!o||!h)return;Ke(s,i=>{if(i[h]===d){i[o]=i[o]||[];for(let g=0;g<a.length;g++)i[o][c](a[g]);return e.value=s,!0}})}else{for(let h=0;h<a.length;h++)s[c](a[h]);e.value=s;return}}function E(d,a){if(!d)return;const c=a||u(e),{key:s,children:h}=u(t);if(!(!h||!s))for(let o=0;o<c.length;o++){const i=c[o],g=i[h];if(i[s]===d){c.splice(o,1);break}else g&&g.length&&E(d,i[h])}}function K(d,a,c){if(!d&&d!==0)return null;const s=a||u(e),{key:h,children:o}=u(t);return h?(s.forEach(i=>{if(c!=null&&c.key||(c==null?void 0:c.key)===0)return c;if(i[h]===d){c=i;return}i[o]&&i[o].length&&(c=K(d,i[o],c))}),c||null):null}return{deleteNodeByKey:E,insertNodeByKey:p,insertNodesByKey:k,filterByLevel:r,updateNodeByKey:S,getAllKeys:n,getChildrenKeys:v,getEnabledKeys:y,getSelectedNode:K}}function Ee(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!nt(e)}const en=_e({name:"BasicTree",inheritAttrs:!1,props:Vt,emits:jt,setup(e,{attrs:t,slots:n,emit:y,expose:v}){const[S]=we("tree"),r=pe({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),p=pe({startSearch:!1,searchText:"",searchData:[]}),k=Te([]),[E]=Dt(),K=I(()=>{const{fieldNames:l}=e;return O({children:"children",title:"title",key:"key"},l)}),d=I(()=>{let l=ue(O(O({blockNode:!0},t),e),{expandedKeys:r.expandedKeys,selectedKeys:r.selectedKeys,checkedKeys:r.checkedKeys,checkStrictly:r.checkStrictly,fieldNames:u(K),"onUpdate:expandedKeys":f=>{r.expandedKeys=f,y("update:expandedKeys",f)},"onUpdate:selectedKeys":f=>{r.selectedKeys=f,y("update:selectedKeys",f)},onCheck:(f,b)=>{let x=X(r.checkedKeys);if(kt(x)&&p.startSearch){const C=b.node.eventKey;x=Ot(x,W(C)),b.checked&&x.push(C),r.checkedKeys=x}else r.checkedKeys=f;const A=X(r.checkedKeys);y("update:value",A),y("check",A,b)},onRightClick:Fe});return St(l,"treeData","class")}),a=I(()=>p.startSearch?p.searchData:u(k)),c=I(()=>!a.value||a.value.length===0),{deleteNodeByKey:s,insertNodeByKey:h,insertNodesByKey:o,filterByLevel:i,updateNodeByKey:g,getAllKeys:_,getChildrenKeys:W,getEnabledKeys:P,getSelectedNode:Be}=Xt(k,K);function De(l,f){return!f&&e.renderIcon&&J(e.renderIcon)?e.renderIcon(l):f}function Fe(b){return oe(this,arguments,function*({event:l,node:f}){var F;const{rightMenuList:x=[],beforeRightClick:A}=e;let C={event:l,items:[]};if(A&&J(A)){let w=yield A(f,l);Array.isArray(w)?C.items=w:Object.assign(C,w)}else C.items=x;(F=C.items)!=null&&F.length&&(C.items=C.items.filter(w=>!w.hidden),E(C))})}function H(l){r.expandedKeys=l}function Ne(){return r.expandedKeys}function ne(l){r.selectedKeys=l}function Me(){return r.selectedKeys}function ae(l){r.checkedKeys=l}function Ie(){return r.checkedKeys}function le(l){r.checkedKeys=l?P():[]}function q(l){r.expandedKeys=l?_():[]}function Oe(l){r.checkStrictly=l}$(()=>e.searchValue,l=>{l!==p.searchText&&(p.searchText=l)},{immediate:!0}),$(()=>e.treeData,l=>{l&&Z(p.searchText)});function Z(l){if(l!==p.searchText&&(p.searchText=l),y("update:searchValue",l),!l){p.startSearch=!1;return}const{filterFn:f,checkable:b,expandOnSearch:x,checkOnSearch:A,selectedOnSearch:C}=u(e);p.startSearch=!0;const{title:F,key:w}=u(K),D=[];if(p.searchData=Kt(u(k),B=>{var R,Y;const N=f?f(l,B,u(K)):(Y=(R=B[F])==null?void 0:R.includes(l))!=null?Y:!1;return N&&D.push(B[w]),N},u(K)),x){const B=xt(p.searchData).map(N=>N[w]);B&&B.length&&H(B)}A&&b&&D.length&&ae(D),C&&D.length&&ne(D)}function me(l,f){if(!(!e.clickRowToExpand||!f||f.length===0))if(!r.expandedKeys.includes(l))H([...r.expandedKeys,l]);else{const b=[...r.expandedKeys],x=b.findIndex(A=>A===l);x!==-1&&b.splice(x,1),H(b)}}V(()=>{k.value=e.treeData}),et(()=>{const l=parseInt(e.defaultExpandLevel);l>0?r.expandedKeys=i(l):e.defaultExpandAll&&q(!0)}),V(()=>{r.expandedKeys=e.expandedKeys}),V(()=>{r.selectedKeys=e.selectedKeys}),V(()=>{r.checkedKeys=e.checkedKeys}),$(()=>e.value,()=>{r.checkedKeys=X(e.value||[])},{immediate:!0}),$(()=>r.checkedKeys,()=>{const l=X(r.checkedKeys);y("update:value",l),y("change",l)}),V(()=>{r.checkStrictly=e.checkStrictly});const $e={getTreeData:()=>k,setExpandedKeys:H,getExpandedKeys:Ne,setSelectedKeys:ne,getSelectedKeys:Me,setCheckedKeys:ae,getCheckedKeys:Ie,insertNodeByKey:h,insertNodesByKey:o,deleteNodeByKey:s,updateNodeByKey:g,getSelectedNode:Be,checkAll:le,expandAll:q,filterByLevel:l=>{r.expandedKeys=i(l)},setSearchValue:l=>{Z(l)},getSearchValue:()=>p.searchText};function Pe(l){const{actionList:f}=e;if(!(!f||f.length===0))return f.map((b,x)=>{var C;let A=!0;return J(b.show)?A=(C=b.show)==null?void 0:C.call(b,l):Ce(b.show)&&(A=b.show),A?L("span",{key:x,class:S("action")},[b.render(l)]):null})}const Ue=I(()=>{const l=ee(a.value);return bt(l,(f,b)=>{var re;const x=p.searchText,{highlight:A}=u(e),{title:C,key:F,children:w}=u(K),D=De(f,f.icon),B=Ft(f,C),N=x?B.indexOf(x):-1,R=p.startSearch&&!Ct(x)&&A&&N!==-1,Y=`color: ${Ce(A)?"#f50":A}`,je=R?L("span",{class:(re=u(d))!=null&&re.blockNode?`${S("content")}`:""},[L("span",null,[B.substr(0,N)]),L("span",{style:Y},[x]),L("span",null,[B.substr(N+x.length)])]):B,ce=D?L(Yt,{icon:D},null):n.icon?L("span",{class:"mr-1"},[be(n,"icon")]):null;return f[C]=L("span",{class:`${S("title")} pl-2`,onClick:me.bind(null,f[F],f[w])},[n!=null&&n.title?L(z,null,[ce,be(n,"title",f)]):L(z,null,[ce,je,L("span",{class:S("actions")},[Pe(f)])])]),f}),l});return v($e),()=>{let l,f;const{title:b,helpMessage:x,toolbar:A,search:C,checkable:F}=e,w=b||A||C||n.headerTitle,D={height:"calc(100% - 38px)"};return L("div",{class:[S(),"h-full",t.class]},[w&&L(Rt,{checkable:F,checkAll:le,expandAll:q,title:b,search:C,toolbar:A,helpMessage:x,onStrictlyChange:Oe,onSearch:Z,searchText:p.searchText},Ee(l=xe(n))?l:{default:()=>[l]}),L(wt,{wrapperClassName:u(e.treeWrapperClassName),spinning:u(e.loading),tip:"加载中..."},{default:()=>[ge(L(At,{style:D},{default:()=>[L(Bt,tt(u(d),{showIcon:!1,treeData:Ue.value}),Ee(f=xe(n,["title"]))?f:{default:()=>[f]})]}),[[ke,!u(c)]]),ge(L(Ae,{image:Ae.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[ke,u(c)]])]})])}}});export{en as _};
