var nt=Object.defineProperty,lt=Object.defineProperties;var ot=Object.getOwnPropertyDescriptors;var Te=Object.getOwnPropertySymbols;var st=Object.prototype.hasOwnProperty,rt=Object.prototype.propertyIsEnumerable;var Pe=(a,o,e)=>o in a?nt(a,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[o]=e,I=(a,o)=>{for(var e in o||(o={}))st.call(o,e)&&Pe(a,e,o[e]);if(Te)for(var e of Te(o))rt.call(o,e)&&Pe(a,e,o[e]);return a},X=(a,o)=>lt(a,ot(o));var B=(a,o,e)=>new Promise((c,d)=>{var h=g=>{try{y(e.next(g))}catch(p){d(p)}},f=g=>{try{y(e.throw(g))}catch(p){d(p)}},y=g=>g.done?c(g.value):Promise.resolve(g.value).then(h,f);y((e=e.apply(a,o)).next())});import{u as de}from"./useFormItem-1ece48e0.js";import{p as F,y as ut,o as re,n as j,i as ee,R as le,a1 as it,h as ct,a2 as dt,I as _e,a3 as Ie,a4 as pt,q as De,X as xe,a as Ne,a5 as Be,Q as ft,w as $e}from"./index.js";import{V as ce,X as oe,r as Ee,Y as mt,Z as Me,$ as ze,a0 as vt,T as je,E as Ge,a1 as gt,a2 as yt,a3 as ht,o as ye,x as bt,a4 as Se,u as _t,a5 as St,M as wt,h as ue,a6 as At,a7 as Ct,a8 as Ft,z as Ke,a9 as kt,aa as Rt,ab as pe,ac as Ve}from"./antd-c2e94c83.js";import{g as Y}from"./get-3d19de2f.js";import{d as G,f as A,c as L,h as we,w as E,Z as k,a8 as O,a9 as R,ac as q,u as n,k as fe,_ as M,aa as ie,F as Q,E as V,a0 as z,ad as me,N as ve,ai as ne,aj as ge,l as b,$ as se,J as Ae,o as Ce,e as Tt,p as Pt,a7 as Fe,ab as K,a1 as he,H as Oe,x as Le,G as We}from"./vue-ea98dac5.js";import{_ as It}from"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-5129e933.js";import{u as xt,a as He,B as Ze,b as Ue}from"./index-4b210e61.js";import{i as Ot}from"./isBoolean-9388e2d6.js";import{b as Lt}from"./uuid-31b8b5a4.js";import{u as Ut}from"./useSortable-f230544c.js";import{d as Dt}from"./download-4dc1f19b.js";import{S as Nt}from"./index-8518e10f.js";import{_ as Bt}from"./IconPicker.vue_vue_type_script_setup_true_lang-6c13fa25.js";import{C as $t}from"./index-8c2ff0df.js";const Et=G({name:"ApiRadioGroup",__name:"ApiRadioGroup",props:{api:{type:Function,default:null},params:{type:[Object,String],default:()=>({})},value:{type:[String,Number,Boolean]},isBtn:{type:[Boolean],default:!1},numberToString:F.bool,resultField:F.string.def(""),labelField:F.string.def("label"),valueField:F.string.def("value"),immediate:F.bool.def(!0)},emits:["options-change","change"],setup(a,{emit:o}){const e=a,c=A([]),d=A(!1),h=A(!0),f=A([]),y=ut(),[g]=de(e,"value","change",f),p=L(()=>{const{labelField:r,valueField:s,numberToString:u}=e;return n(c).reduce((i,T)=>{if(T){const x=T[s];i.push(I({label:T[r],value:u?`${x}`:x},re(T,[r,s])))}return i},[])});we(()=>{e.immediate&&m()}),E(()=>e.params,()=>{!n(h)&&m()},{deep:!0});function m(){return B(this,null,function*(){const r=e.api;if(!(!r||!j(r))){c.value=[];try{d.value=!0;const s=yield r(e.params);if(Array.isArray(s)){c.value=s,t();return}e.resultField&&(c.value=Y(s,e.resultField)||[]),t()}catch(s){}finally{d.value=!1}}})}function t(){o("options-change",n(p))}function l(...r){f.value=r}return(r,s)=>(k(),O(n(ce).Group,q(n(y),{value:n(g),"onUpdate:value":s[0]||(s[0]=u=>fe(g)?g.value=u:null),"button-style":"solid"}),{default:R(()=>[(k(!0),M(Q,null,ie(p.value,u=>(k(),M(Q,{key:`${u.value}`},[e.isBtn?(k(),O(n(ce).Button,{key:0,value:u.value,disabled:u.disabled,onClick:i=>l(u)},{default:R(()=>[V(z(u.label),1)]),_:2},1032,["value","disabled","onClick"])):(k(),O(n(ce),{key:1,value:u.value,disabled:u.disabled,onClick:i=>l(u)},{default:R(()=>[V(z(u.label),1)]),_:2},1032,["value","disabled","onClick"]))],64))),128))]),_:1},16,["value"]))}}),Mt=G({name:"ApiSelect",inheritAttrs:!1,__name:"ApiSelect",props:{value:{type:[Array,Object,String,Number]},numberToString:F.bool,api:{type:Function,default:null},params:F.any.def({}),resultField:F.string.def(""),labelField:F.string.def("label"),valueField:F.string.def("value"),immediate:F.bool.def(!0),alwaysLoad:F.bool.def(!1),options:{type:Array,default:[]}},emits:["options-change","change","update:value"],setup(a,{emit:o}){const e=a,c=A([]),d=A(!1),h=A(!1),f=A([]),{t:y}=ee(),[g]=de(e,"value","change",f),p=L(()=>{const{labelField:s,valueField:u,numberToString:i}=e;let T=n(c).reduce((x,N)=>{if(N){const W=Y(N,u);x.push(X(I({},re(N,[s,u])),{label:Y(N,s),value:i?`${W}`:W}))}return x},[]);return T.length>0?T:e.options});E(()=>g.value,s=>{o("update:value",s)}),E(()=>e.params,()=>{!n(h)&&m()},{deep:!0,immediate:e.immediate});function m(){return B(this,null,function*(){const s=e.api;if(!(!s||!j(s)||d.value)){c.value=[];try{d.value=!0;const u=yield s(e.params);if(h.value=!0,Array.isArray(u)){c.value=u,l();return}e.resultField&&(c.value=Y(u,e.resultField)||[]),l()}catch(u){}finally{d.value=!1,h.value=!1}}})}function t(s){return B(this,null,function*(){s&&(e.alwaysLoad?yield m():!e.immediate&&!n(h)&&(yield m()))})}function l(){o("options-change",n(p))}function r(s,...u){f.value=u}return(s,u)=>(k(),O(n(Ee),q({onDropdownVisibleChange:t},s.$attrs,{onChange:r,options:p.value,value:n(g),"onUpdate:value":u[0]||(u[0]=i=>fe(g)?g.value=i:null)}),me({_:2},[ie(Object.keys(s.$slots),i=>({name:i,fn:R(T=>[ve(s.$slots,i,ne(ge(T||{})))])})),d.value?{name:"suffixIcon",fn:R(()=>[b(n(oe),{spin:""})]),key:"0"}:void 0,d.value?{name:"notFoundContent",fn:R(()=>[se("span",null,[b(n(oe),{spin:"",class:"mr-1"}),V(" "+z(n(y)("component.form.apiSelectNotFound")),1)])]),key:"1"}:void 0]),1040,["options","value"]))}}),zt=G({name:"ApiTree",__name:"ApiTree",props:{api:{type:Function},params:{type:Object},immediate:{type:Boolean,default:!0},resultField:{type:String,default:""},afterFetch:{type:Function},value:{type:Array}},emits:["options-change","change","update:value"],setup(a,{emit:o}){const e=a,c=Ae(),d=A([]),h=A(!1),f=A(!1),y=A([]),[g]=de(e,"value","change",y),p=L(()=>I(I({},e.api?{treeData:n(d)}:{}),c));E(()=>g.value,t=>{o("update:value",t)}),E(()=>e.params,()=>{!n(h)&&m()},{deep:!0}),E(()=>e.immediate,t=>{t&&!h.value&&m()}),Ce(()=>{e.immediate&&m()});function m(){return B(this,null,function*(){const{api:t,afterFetch:l}=e;if(!t||!j(t))return;f.value=!0,d.value=[];let r;try{r=yield t(e.params)}catch(s){}l&&j(l)&&(r=l(r)),f.value=!1,r&&(le(r)||(r=Y(r,e.resultField)),d.value=r||[],h.value=!0,o("options-change",d.value))})}return(t,l)=>(k(),O(n(mt),q(p.value,{selectedKeys:n(g),"onUpdate:selectedKeys":l[0]||(l[0]=r=>fe(g)?g.value=r:null)}),me({_:2},[ie(Object.keys(t.$slots),r=>({name:r,fn:R(s=>[ve(t.$slots,r,ne(ge(s||{})))])}))]),1040,["selectedKeys"]))}}),jt=G({name:"ApiTreeSelect",__name:"ApiTreeSelect",props:{api:{type:Function},params:{type:Object},immediate:{type:Boolean,default:!0},async:{type:Boolean,default:!1},resultField:F.string.def(""),labelField:F.string.def("title"),valueField:F.string.def("value"),childrenField:F.string.def("children")},emits:["options-change","change","load-data"],setup(a,{emit:o}){const e=a,c=Ae(),d=A([]),h=A(!1),f=A(!1),y=L(()=>I(I({},e.api?{treeData:n(d)}:{}),c)),g={children:e.childrenField,value:e.valueField,label:e.labelField};function p(...l){o("change",...l)}E(()=>e.params,()=>{!n(h)&&t()},{deep:!0}),E(()=>e.immediate,l=>{l&&!h.value&&t()}),Ce(()=>{e.immediate&&t()});function m(l){return new Promise(r=>{if(le(l.children)&&l.children.length>0){r();return}o("load-data",{treeData:d,treeNode:l,resolve:r})})}function t(){return B(this,null,function*(){const{api:l}=e;if(!l||!j(l)||f.value)return;f.value=!0,d.value=[];let r;try{r=yield l(e.params)}catch(s){}f.value=!1,r&&(le(r)||(r=Y(r,e.resultField)),d.value=r||[],h.value=!0,o("options-change",d.value))})}return(l,r)=>(k(),O(n(Me),q(y.value,{onChange:p,"field-names":g,"load-data":a.async?m:void 0}),me({_:2},[ie(Object.keys(l.$slots),s=>({name:s,fn:R(u=>[ve(l.$slots,s,ne(ge(u||{})))])})),f.value?{name:"suffixIcon",fn:R(()=>[b(n(oe),{spin:""})]),key:"0"}:void 0]),1040,["load-data"]))}}),Gt=G({name:"ApiCascader",__name:"ApiCascader",props:{value:{type:Array},api:{type:Function,default:null},numberToString:F.bool,resultField:F.string.def(""),labelField:F.string.def("label"),valueField:F.string.def("value"),childrenField:F.string.def("children"),apiParamKey:F.string.def("parentCode"),immediate:F.bool.def(!0),initFetchParams:{type:Object,default:()=>({})},isLeaf:{type:Function,default:null},displayRenderArray:{type:Array}},emits:["change","defaultChange"],setup(a,{emit:o}){const e=a,c=A([]),d=A([]),h=A(!1),f=A([]),y=A(!0),{t:g}=ee(),[p]=de(e,"value","change",f);E(c,u=>{const i=m(u);d.value=i},{deep:!0});function m(u){const{labelField:i,valueField:T,numberToString:x,childrenField:N,isLeaf:W}=e;return u.reduce((ae,H)=>{if(H){const te=H[T],_=X(I({},re(H,[i,T])),{label:H[i],value:x?`${te}`:te,isLeaf:W&&typeof W=="function"?W(H):!1}),C=Reflect.get(H,N);C&&Reflect.set(_,N,m(C)),ae.push(_)}return ae},[])}function t(){return B(this,null,function*(){const u=e.api;if(!(!u||!j(u))){c.value=[],h.value=!0;try{const i=yield u(e.initFetchParams);if(Array.isArray(i)){c.value=i;return}e.resultField&&(c.value=Y(i,e.resultField)||[])}catch(i){}finally{h.value=!1}}})}const l=u=>B(this,null,function*(){const i=u[u.length-1];i.loading=!0;const T=e.api;if(!(!T||!j(T)))try{const x=yield T({[e.apiParamKey]:Reflect.get(i,"value")});if(Array.isArray(x)){const N=m(x);i.children=N;return}if(e.resultField){const N=m(Y(x,e.resultField)||[]);i.children=N}}catch(x){}finally{i.loading=!1}});we(()=>{e.immediate&&t()}),E(()=>e.initFetchParams,()=>{!n(y)&&t()},{deep:!0});function r(u,i){f.value=i,o("defaultChange",u,i)}const s=({labels:u,selectedOptions:i})=>n(f).length===(i==null?void 0:i.length)?u.join(" / "):e.displayRenderArray?e.displayRenderArray.join(" / "):"";return(u,i)=>(k(),O(n(ze),{value:n(p),"onUpdate:value":i[0]||(i[0]=T=>fe(p)?p.value=T:null),options:d.value,"load-data":l,"change-on-select":"",onChange:r,displayRender:s},me({_:2},[h.value?{name:"suffixIcon",fn:R(()=>[b(n(oe),{spin:""})]),key:"0"}:void 0,h.value?{name:"notFoundContent",fn:R(()=>[se("span",null,[b(n(oe),{spin:"",class:"mr-1"}),V(" "+z(n(g)("component.form.apiSelectNotFound")),1)])]),key:"1"}:void 0]),1032,["value","options"]))}}),Kt=G({name:"ApiTransfer",__name:"ApiTransfer",props:{value:{type:Array},api:{type:Function,default:null},params:{type:Object},dataSource:{type:Array},immediate:F.bool.def(!0),alwaysLoad:F.bool.def(!1),afterFetch:{type:Function},resultField:F.string.def(""),labelField:F.string.def("title"),valueField:F.string.def("key"),showSearch:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},filterOption:{type:Function},selectedKeys:{type:Array},showSelectAll:{type:Boolean,default:!1},targetKeys:{type:Array}},emits:["options-change","change"],setup(a,{emit:o}){const e=a,c=A([]),d=A([]),h=L(()=>{const{labelField:m,valueField:t}=e;return n(c).reduce((l,r)=>(r&&l.push(X(I({},re(r,[m,t])),{title:r[m],key:r[t]})),l),[])}),f=L(()=>Array.isArray(e.value)?e.value:Array.isArray(e.targetKeys)?e.targetKeys:[]);function y(m,t,l){d.value=m,o("change",m)}we(()=>{e.immediate&&!e.alwaysLoad&&g()}),E(()=>e.params,()=>{g()},{deep:!0});function g(){return B(this,null,function*(){const m=e.api;if(!m||!j(m)){Array.isArray(e.dataSource)&&(c.value=e.dataSource);return}c.value=[];try{const t=yield m(e.params);if(Array.isArray(t)){c.value=t,p();return}e.resultField&&(c.value=Y(t,e.resultField)||[]),p()}catch(t){}})}function p(){o("options-change",n(h))}return(m,t)=>(k(),O(n(vt),{"data-source":h.value,"filter-option":a.filterOption,render:l=>l.title,showSelectAll:a.showSelectAll,selectedKeys:a.selectedKeys,targetKeys:f.value,showSearch:a.showSearch,disabled:a.disabled,onChange:y},null,8,["data-source","filter-option","render","showSelectAll","selectedKeys","targetKeys","showSearch","disabled"]))}}),qe={listType:{type:String,default:"picture-card"},helpText:{type:String,default:""},maxSize:{type:Number,default:2},maxNumber:{type:Number,default:1},accept:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!1},uploadParams:{type:Object,default:()=>({})},api:{type:Function,default:null,required:!0},name:{type:String,default:"file"},filename:{type:String,default:null},fileListOpenDrag:{type:Boolean,default:!0},fileListDragOptions:{type:Object,default:()=>({})}},Xe=X(I({value:{type:Array,default:()=>[]}},qe),{showPreviewNumber:{type:Boolean,default:!0},emptyHidePreview:{type:Boolean,default:!1}}),Vt={value:{type:Array,default:()=>[]}},Wt={columns:{type:Array,default:null},actionColumn:{type:Object,default:null},dataSource:{type:Array,default:null},openDrag:{type:Boolean,default:!1},dragOptions:{type:Object,default:()=>({})}},{t:be}=ee();function Ye({acceptRef:a,helpTextRef:o,maxNumberRef:e,maxSizeRef:c}){const d=L(()=>{const y=n(a);return y&&y.length>0?y:[]}),h=L(()=>n(d).map(y=>y.indexOf("/")>0||y.startsWith(".")?y:`.${y}`).join(",")),f=L(()=>{const y=n(o);if(y)return y;const g=[],p=n(a);p.length>0&&g.push(be("component.upload.accept",[p.join(",")]));const m=n(c);m&&g.push(be("component.upload.maxSize",[m]));const t=n(e);return t&&t!==1/0&&g.push(be("component.upload.maxNumber",[t])),g.join("，")});return{getAccept:d,getStringAccept:h,getHelpText:f}}var D=(a=>(a.DONE="done",a.SUCCESS="success",a.ERROR="error",a.UPLOADING="uploading",a))(D||{});function Ht(a){return ke(a.name)}function ke(a){return/\.(jpg|jpeg|png|gif|webp)$/i.test(a)}function Zt(a){return new Promise((o,e)=>{const c=new FileReader;c.readAsDataURL(a),c.onload=()=>o({result:c.result,file:a}),c.onerror=d=>e(d)})}const Je=Symbol("basic-table");function Ua(a){Pt(Je,a)}function qt(){return Tt(Je)}const{table:Xt}=it,{pageSizeOptions:Yt,defaultPageSize:Jt,fetchSetting:Qt,defaultSize:ea,defaultSortFn:ta,defaultFilterFn:aa}=Xt,Da="key",Na=Yt,Ba=Jt,$a=Qt,Ea=ea,Ma=ta,za=aa,ja="center",Ga="INDEX",na="ACTION",Qe=G({name:"TableAction",__name:"TableAction",props:{actions:{type:Array,default:null},dropDownActions:{type:Array,default:null},divider:F.bool.def(!0),outside:F.bool,stopButtonPropagation:F.bool.def(!1)},setup(a){const o=a,{prefixCls:e}=ct("basic-table-action");let c={};o.outside||(c=qt());const{hasPermission:d}=dt();function h(t){const l=t.ifShow;let r=!0;return Ot(l)&&(r=l),j(l)&&(r=l(t)),r}const f=L(()=>(Oe(o.actions)||[]).filter(t=>d(t.auth)&&h(t)).map(t=>{const{popConfirm:l}=t;return X(I(I({getPopupContainer:()=>{var r;return(r=n(c==null?void 0:c.wrapRef))!=null?r:document.body},type:"link",size:"small"},t),l||{}),{onConfirm:l==null?void 0:l.confirm,onCancel:l==null?void 0:l.cancel,enable:!!l})})),y=L(()=>{const t=(Oe(o.dropDownActions)||[]).filter(l=>d(l.auth)&&h(l));return t.map((l,r)=>{const{label:s,popConfirm:u}=l;return X(I(I({},l),u),{onConfirm:u==null?void 0:u.confirm,onCancel:u==null?void 0:u.cancel,text:s,divider:r<t.length-1?o.divider:!1})})}),g=L(()=>{var r,s;const l=(((r=c==null?void 0:c.getColumns)==null?void 0:r.call(c))||[]).find(u=>u.flag===na);return(s=l==null?void 0:l.align)!=null?s:"left"});function p(t){return I({getPopupContainer:()=>{var l;return(l=n(c==null?void 0:c.wrapRef))!=null?l:document.body},placement:"bottom"},De(t)?{title:t}:t)}function m(t){if(!o.stopButtonPropagation)return;t.composedPath().find(s=>{var u;return((u=s.tagName)==null?void 0:u.toUpperCase())==="BUTTON"})&&t.stopPropagation()}return(t,l)=>{const r=Fe("a-button");return k(),M("div",{class:he([n(e),g.value]),onClick:m},[(k(!0),M(Q,null,ie(f.value,(s,u)=>(k(),M(Q,{key:`${u}-${s.label}`},[s.tooltip?(k(),O(n(je),ne(q({key:0},p(s.tooltip))),{default:R(()=>[b(n(Ie),ne(ge(s)),{default:R(()=>[s.icon?(k(),O(_e,{key:0,icon:s.icon,class:he({"mr-1":!!s.label})},null,8,["icon","class"])):K("",!0),s.label?(k(),M(Q,{key:1},[V(z(s.label),1)],64)):K("",!0)]),_:2},1040)]),_:2},1040)):(k(),O(n(Ie),ne(q({key:1},s)),{default:R(()=>[s.icon?(k(),O(_e,{key:0,icon:s.icon,class:he({"mr-1":!!s.label})},null,8,["icon","class"])):K("",!0),s.label?(k(),M(Q,{key:1},[V(z(s.label),1)],64)):K("",!0)]),_:2},1040)),a.divider&&u<f.value.length-1?(k(),O(n(Ge),{key:2,type:"vertical",class:"action-divider"})):K("",!0)],64))),128)),a.dropDownActions&&y.value.length>0?(k(),O(n(pt),{key:0,trigger:["hover"],dropMenuList:y.value,popconfirm:""},{default:R(()=>[ve(t.$slots,"more"),t.$slots.more?K("",!0):(k(),O(r,{key:0,type:"link",size:"small"},{default:R(()=>[b(n(gt),{class:"icon-more"})]),_:1}))]),_:3},8,["dropMenuList"])):K("",!0)],2)}}});const la={class:"thumb"},et=G({__name:"ThumbUrl",props:{fileUrl:F.string.def(""),fileName:F.string.def("")},setup(a){return(o,e)=>(k(),M("span",la,[a.fileUrl?(k(),O(n(yt),{key:0,src:a.fileUrl,width:104},null,8,["src"])):K("",!0)]))}});const{t:$}=ee();function oa(){return[{dataIndex:"thumbUrl",title:$("component.upload.legend"),width:100,customRender:({record:a})=>{const{thumbUrl:o}=a||{};return o&&b(et,{fileUrl:o},null)}},{dataIndex:"name",title:$("component.upload.fileName"),align:"left",customRender:({text:a,record:o})=>{const{percent:e,status:c}=o||{};let d="normal";return c===D.ERROR?d="exception":c===D.UPLOADING?d="active":c===D.SUCCESS&&(d="success"),b("div",null,[b("p",{class:"truncate mb-1 max-w-[280px]",title:a},[a]),b(ht,{percent:e,size:"small",status:d},null)])}},{dataIndex:"size",title:$("component.upload.fileSize"),width:100,customRender:({text:a=0})=>a&&(a/1024).toFixed(2)+"KB"},{dataIndex:"status",title:$("component.upload.fileStatue"),width:100,customRender:({text:a})=>a===D.SUCCESS?b(ye,{color:"green"},{default:()=>$("component.upload.uploadSuccess")}):a===D.ERROR?b(ye,{color:"red"},{default:()=>$("component.upload.uploadError")}):a===D.UPLOADING?b(ye,{color:"blue"},{default:()=>$("component.upload.uploading")}):a||$("component.upload.pending")}]}function sa(a){return{width:120,title:$("component.upload.operating"),dataIndex:"action",fixed:!1,customRender:({record:o})=>{const e=[{label:$("component.upload.del"),color:"error",onClick:a.bind(null,o)}];return b(Qe,{actions:e,outside:!0},null)}}}function ra(){return[{dataIndex:"url",title:$("component.upload.legend"),width:100,customRender:({record:a})=>{const{url:o}=a||{};return ke(o)&&b(et,{fileUrl:o},null)}},{dataIndex:"name",title:$("component.upload.fileName"),align:"left"}]}function ua({handleRemove:a,handleDownload:o}){return{width:160,title:$("component.upload.operating"),dataIndex:"action",fixed:!1,customRender:({record:e})=>{const c=[{label:$("component.upload.del"),color:"error",onClick:a.bind(null,e)},{label:$("component.upload.download"),onClick:o.bind(null,e)}];return b(Qe,{actions:c,outside:!0},null)}}}const tt=G({name:"FileList",props:Wt,setup(a,{emit:o}){const e=xt(),c=A();return E(()=>a.dataSource,()=>{Le(()=>{var d;(d=e==null?void 0:e.redoModalHeight)==null||d.call(e)})}),a.openDrag&&Ce(()=>Ut(c,X(I({},a.dragOptions),{onEnd:({oldIndex:d,newIndex:h})=>{if(d===h)return;const{onAfterEnd:f}=a.dragOptions;if(xe(d)&&xe(h)){const y=[...a.dataSource],[g]=y.splice(d,1);y.splice(h,0,g),Le(()=>{o("update:dataSource",y),j(f)&&f(y)})}}})).initSortable()),()=>{const{columns:d,actionColumn:h,dataSource:f}=a,y=[...d,h];return b("div",{class:"overflow-x-auto"},[b("table",{class:"file-table"},[b("colgroup",null,[y.map(g=>{const{width:p=0,dataIndex:m}=g,t={width:`${p}px`,minWidth:`${p}px`};return b("col",{style:p?t:{},key:m},null)})]),b("thead",null,[b("tr",{class:"file-table-tr"},[y.map(g=>{const{title:p="",align:m="center",dataIndex:t}=g;return b("th",{class:["file-table-th",m],key:t},[p])})])]),b("tbody",{ref:c},[f.map((g={},p)=>b("tr",{class:"file-table-tr",key:`${p+g.name||""}`},[y.map(m=>{const{dataIndex:t="",customRender:l,align:r="center"}=m,s=l&&j(l);return b("td",{class:["file-table-td break-all",r],key:t},[s?l==null?void 0:l({text:g[t],record:g}):g[t]])})]))])])])}}});const ia={class:"upload-modal-toolbar"},ca=G({__name:"UploadModal",props:X(I({},qe),{previewFileList:{type:Array,default:()=>[]}}),emits:["change","register","delete"],setup(a,{emit:o}){const e=a,c=oa(),d=sa(ae),h=A(!1),f=A([]),{accept:y,helpText:g,maxNumber:p,maxSize:m}=We(e),{t}=ee(),[l,{closeModal:r}]=He(),{getStringAccept:s,getHelpText:u}=Ye({acceptRef:y,helpTextRef:g,maxNumberRef:p,maxSizeRef:m}),{createMessage:i}=Ne(),T=L(()=>f.value.length>0&&!f.value.every(v=>v.status===D.SUCCESS)),x=L(()=>{const v=f.value.some(S=>S.status===D.SUCCESS);return{disabled:h.value||f.value.length===0||!v}}),N=L(()=>{const v=f.value.some(S=>S.status===D.ERROR);return h.value?t("component.upload.uploading"):t(v?"component.upload.reUploadFailed":"component.upload.startUpload")});function W(v){const{size:S,name:P}=v,{maxSize:U}=e;if(U&&v.size/1024/1024>=U)return i.error(t("component.upload.maxSizeMultiple",[U])),!1;const Z={uuid:Lt(),file:v,size:S,name:P,percent:0,type:P.split(".").pop()};return Ht(v)?Zt(v).then(({result:J})=>{f.value=[...n(f),I({thumbUrl:J},Z)]}):f.value=[...n(f),Z],!1}function ae(v){const S=f.value.findIndex(P=>P.uuid===v.uuid);S!==-1&&f.value.splice(S,1),o("delete",v)}function H(v){return B(this,null,function*(){var P;const{api:S}=e;if(!S||!j(S))return Be();try{v.status=D.UPLOADING;const U=yield(P=e.api)==null?void 0:P.call(e,{data:I({},e.uploadParams||{}),file:v.file,name:e.name,filename:e.filename},function(Re){const at=Re.loaded/Re.total*100|0;v.percent=at}),{data:Z}=U;return v.status=D.SUCCESS,v.response=Z,{success:!0,error:null}}catch(U){return v.status=D.ERROR,{success:!1,error:U}}})}function te(){return B(this,null,function*(){var S;const{maxNumber:v}=e;if(f.value.length+((S=e.previewFileList)==null?void 0:S.length)>v)return i.warning(t("component.upload.maxNumber",[v]));try{h.value=!0;const P=f.value.filter(J=>J.status!==D.SUCCESS)||[],U=yield Promise.all(P.map(J=>H(J)));h.value=!1;const Z=U.filter(J=>!J.success);if(Z.length>0)throw Z}catch(P){throw h.value=!1,P}})}function _(){const{maxNumber:v}=e;if(f.value.length>v)return i.warning(t("component.upload.maxNumber",[v]));if(h.value)return i.warning(t("component.upload.saveWarn"));const S=[];for(const P of f.value){const{status:U,response:Z}=P;U===D.SUCCESS&&Z&&S.push(Z.url)}if(S.length<=0)return i.warning(t("component.upload.saveError"));f.value=[],r(),o("change",S)}function C(){return B(this,null,function*(){return h.value?(i.warning(t("component.upload.uploadWait")),!1):(f.value=[],!0)})}return(v,S)=>{const P=Fe("a-button");return k(),O(n(Ze),q({width:"800px",title:n(t)("component.upload.upload"),okText:n(t)("component.upload.save")},v.$attrs,{onRegister:n(l),onOk:_,closeFunc:C,maskClosable:!1,keyboard:!1,class:"upload-modal",okButtonProps:x.value,cancelButtonProps:{disabled:h.value}}),{centerFooter:R(()=>[b(P,{onClick:te,color:"success",disabled:!T.value,loading:h.value},{default:R(()=>[V(z(N.value),1)]),_:1},8,["disabled","loading"])]),default:R(()=>[se("div",ia,[b(n(bt),{message:n(u),type:"info",banner:"",class:"upload-modal-toolbar__text"},null,8,["message"]),b(n(Se),{accept:n(s),multiple:v.multiple,"before-upload":W,"show-upload-list":!1,class:"upload-modal-toolbar__btn"},{default:R(()=>[b(P,{type:"primary"},{default:R(()=>[V(z(n(t)("component.upload.choose")),1)]),_:1})]),_:1},8,["accept","multiple"])]),b(tt,{dataSource:f.value,"onUpdate:dataSource":S[0]||(S[0]=U=>f.value=U),columns:n(c),actionColumn:n(d),openDrag:v.fileListOpenDrag,dragOptions:v.fileListDragOptions},null,8,["dataSource","columns","actionColumn","openDrag","dragOptions"])]),_:1},16,["title","okText","onRegister","okButtonProps","cancelButtonProps"])}}});const da=G({__name:"UploadPreviewModal",props:Vt,emits:["list-change","register","delete"],setup(a,{emit:o}){const e=a,c=ra(),d=ua({handleRemove:g,handleDownload:p}),[h]=He(),{t:f}=ee(),y=A([]);E(()=>e.value,m=>{le(m)||(m=[]),y.value=m.filter(t=>!!t).map(t=>({url:t,type:t.split(".").pop()||"",name:t.split("/").pop()||""}))},{immediate:!0});function g(m){const t=y.value.findIndex(l=>l.url===m.url);if(t!==-1){const l=y.value.splice(t,1);o("delete",l[0].url),o("list-change",y.value.map(r=>r.url))}}function p(m){const{url:t=""}=m;Dt({url:t})}return(m,t)=>(k(),O(n(Ze),q({width:"800px",title:n(f)("component.upload.preview"),class:"upload-preview-modal"},m.$attrs,{onRegister:n(h),showOkBtn:!1}),{default:R(()=>[b(tt,{dataSource:y.value,columns:n(c),actionColumn:n(d)},null,8,["dataSource","columns","actionColumn"])]),_:1},16,["title","onRegister"]))}});const pa=G({name:"BasicUpload",__name:"BasicUpload",props:Xe,emits:["change","delete","preview-delete","update:value"],setup(a,{emit:o}){const e=a,c=Ae(),{t:d}=ee(),[h,{openModal:f}]=Ue(),[y,{openModal:g}]=Ue(),p=A([]),m=L(()=>{const{emptyHidePreview:i}=e;return i&&i?p.value.length>0:!0}),t=L(()=>{const i=I(I({},c),e);return re(i,"onChange")});E(()=>e.value,(i=[])=>{p.value=le(i)?i:[]},{immediate:!0});function l(i){p.value=[...n(p),...i||[]],o("update:value",p.value),o("change",p.value)}function r(i){p.value=[...i||[]],o("update:value",p.value),o("change",p.value)}function s(i){o("delete",i)}function u(i){o("preview-delete",i)}return(i,T)=>{const x=Fe("a-button");return k(),M("div",null,[b(n(_t),null,{default:R(()=>[b(x,{type:"primary",onClick:n(f),preIcon:"carbon:cloud-upload"},{default:R(()=>[V(z(n(d)("component.upload.upload")),1)]),_:1},8,["onClick"]),m.value?(k(),O(n(je),{key:0,placement:"bottom"},{title:R(()=>[V(z(n(d)("component.upload.uploaded"))+" ",1),p.value.length?(k(),M(Q,{key:0},[V(z(p.value.length),1)],64)):K("",!0)]),default:R(()=>[b(x,{onClick:n(g)},{default:R(()=>[b(_e,{icon:"bi:eye"}),p.value.length&&i.showPreviewNumber?(k(),M(Q,{key:0},[V(z(p.value.length),1)],64)):K("",!0)]),_:1},8,["onClick"])]),_:1})):K("",!0)]),_:1}),b(ca,q(t.value,{previewFileList:p.value,fileListOpenDrag:i.fileListOpenDrag,fileListDragOptions:i.fileListDragOptions,onRegister:n(h),onChange:l,onDelete:s}),null,16,["previewFileList","fileListOpenDrag","fileListDragOptions","onRegister"]),b(da,{value:p.value,onRegister:n(y),onListChange:r,onDelete:u},null,8,["value","onRegister"])])}}}),fa={key:0},ma={style:{"margin-top":"8px"}},va=["src"],ga=G({name:"ImageUpload",__name:"ImageUpload",props:I({},Xe),emits:["change","update:value","delete"],setup(a,{emit:o}){const e=a,{t:c}=ee(),{createMessage:d}=Ne(),{accept:h,helpText:f,maxNumber:y,maxSize:g}=We(e),p=A(!1),{getStringAccept:m}=Ye({acceptRef:h,helpTextRef:f,maxNumberRef:y,maxSizeRef:g}),t=A(!1),l=A(""),r=A(""),s=A([]),u=A(!0),i=A(!0);E(()=>e.value,_=>{if(p.value){p.value=!1;return}if(_){let C=[];le(_)?C=_:C.push(_),s.value=C.map((v,S)=>v&&De(v)?{uid:-S+"",name:v.substring(v.lastIndexOf("/")+1),status:"done",url:v}:v&&ft(v)?v:void 0)}});function T(_){return new Promise((C,v)=>{const S=new FileReader;S.readAsDataURL(_),S.onload=()=>{C(S.result)},S.onerror=P=>v(P)})}const x=_=>B(this,null,function*(){!_.url&&!_.preview&&(_.preview=yield T(_.originFileObj)),l.value=_.url||_.preview||"",t.value=!0,r.value=_.name||l.value.substring(l.value.lastIndexOf("/")+1)}),N=_=>B(this,null,function*(){if(s.value){const C=s.value.findIndex(S=>S.uid===_.uid);C!==-1&&s.value.splice(C,1);const v=te();p.value=!0,o("change",v),o("delete",_)}}),W=()=>{t.value=!1,r.value=""},ae=_=>{const{maxSize:C,accept:v}=e,{name:S}=_,P=ke(S);P||(d.error(c("component.upload.acceptUpload",[v])),i.value=!1,setTimeout(()=>i.value=!0,1e3));const U=_.size/1024/1024>C;return U&&(d.error(c("component.upload.maxSizeMultiple",[C])),u.value=!1,setTimeout(()=>u.value=!0,1e3)),P&&!U||Se.LIST_IGNORE};function H(_){return B(this,null,function*(){var v;const{api:C}=e;if(!C||!j(C))return Be();try{const S=yield(v=e.api)==null?void 0:v.call(e,{data:I({},e.uploadParams||{}),file:_.file,name:e.name,filename:e.filename});_.onSuccess(S.data);const P=te();p.value=!0,o("change",P)}catch(S){_.onError(S)}})}function te(){const _=(s.value||[]).filter(C=>(C==null?void 0:C.status)===D.DONE).map(C=>{var v;return(C==null?void 0:C.url)||((v=C==null?void 0:C.response)==null?void 0:v.url)});return e.multiple?_:_.length>0?_[0]:""}return(_,C)=>(k(),M("div",null,[b(n(Se),q(_.$attrs,{"file-list":s.value,"onUpdate:fileList":C[0]||(C[0]=v=>s.value=v),"list-type":_.listType,accept:n(m),multiple:_.multiple,maxCount:n(y),"before-upload":ae,"custom-request":H,onPreview:x,onRemove:N}),{default:R(()=>[s.value&&s.value.length<n(y)?(k(),M("div",fa,[b(n(St)),se("div",ma,z(n(c)("component.upload.upload")),1)])):K("",!0)]),_:1},16,["file-list","list-type","accept","multiple","maxCount"]),b(n(wt),{open:t.value,title:r.value,footer:null,onCancel:W},{default:R(()=>[se("img",{alt:"",style:{width:"100%"},src:l.value},null,8,va)]),_:1},8,["open","title"])]))}});const ya=$e(ga),ha=$e(pa),w=new Map;w.set("Input",ue);w.set("InputGroup",ue.Group);w.set("InputPassword",ue.Password);w.set("InputSearch",ue.Search);w.set("InputTextArea",ue.TextArea);w.set("InputNumber",At);w.set("AutoComplete",Ct);w.set("ImageUpload",ya);w.set("Select",Ee);w.set("ApiSelect",Mt);w.set("ApiTree",zt);w.set("TreeSelect",Me);w.set("ApiTreeSelect",jt);w.set("ApiRadioGroup",Et);w.set("Switch",Ft);w.set("RadioButtonGroup",It);w.set("RadioGroup",ce.Group);w.set("Checkbox",Ke);w.set("CheckboxGroup",Ke.Group);w.set("ApiCascader",Gt);w.set("Cascader",ze);w.set("Slider",kt);w.set("Rate",Rt);w.set("ApiTransfer",Kt);w.set("DatePicker",pe);w.set("MonthPicker",pe.MonthPicker);w.set("RangePicker",pe.RangePicker);w.set("WeekPicker",pe.WeekPicker);w.set("TimePicker",Ve);w.set("TimeRangePicker",Ve.TimeRangePicker);w.set("StrengthMeter",Nt);w.set("IconPicker",Bt);w.set("InputCountDown",$t);w.set("Upload",ha);w.set("Divider",Ge);function Ka(a,o){w.set(a,o)}export{na as A,ha as B,ja as D,$a as F,Ga as I,Ba as P,Da as R,Mt as _,Qe as a,Na as b,w as c,Ua as d,jt as e,Et as f,Ma as g,za as h,Ea as i,Ka as j,qt as u};
